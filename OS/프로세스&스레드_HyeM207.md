# 프로세스&스레드 간략정리

- 프로세스 : 메모리에서 실행중인 프로그램
- 스레드 : 프로세스 안에서 실행되는 흐름 단위; 하나의 코드 실행 흐름

<br>

## ▶ 프로세스 
> 메모리에서 실행중인 프로그램

프로그램을 실행하면 메모리 위에서 실행되는데, 이때 메모리상에서 실행중인 프로그램을 말한다. 
프로세스는 최소 1개의 스레드를 소유하고, 프로세스는 각각 별도의 주소 공간을 할당받는다.

공간은 크게 4가지로 구분된다.
| 영역 | 설명 |
| - | - |
| code | 코드 자체를 구성하는 메모리 영역 | 
| data | 전역변수, 정적변수, 배열 <br> 초기화 된 변수는 data 영역에, 초기화 안 된 변수는 bss 영역에 저장 | 
| heap | 동적 할당 시 사용 (new()나 malloc()함수) |
| stack |지역변수, 함수의 매개변수, 리턴값 (임시 메모리 영역) |   

<br>

#### ❓ 프로세스 구역을 왜 나눴을까?
구역을 나눈 이유는 <u>최대한 데이터를 공유하여 메모리 사용량을 줄이기 위해서</u> 이다.    

Code 부분은 같은 프로그램에서는 모두 같은 내용이므로 따로 관리하여 공유한다.   
Data와 Stack를 나눈 이유는 `스택구조 특성과 전역 변수 활용 구성`을 위한 것이다.   
(stack의 함수와 지역변수의 경우 LIFO특성의 스택에서 실행됨으로, 전역변수는 data 영역에 따로 지정해서 관리하면 메모리를 아낄 수 잇따.)

<br>

## ▶ 스레드 
> 프로세스 안에서 실행되는 흐름 단위; 하나의 코드 실행 흐름

스레드는 프로세스 안에서 실행되는 흐름 단위로, 스레드는 stack만 할당 받고 나머지 영역은 서로 공유한다. 

<Br>

## ✅ 프로세스와 스레드의 차이
프로세스는 <b>자신만의 고유 공간&자원을 할당</b> 받지만, 스레드는 다른 스레드와 공간&자원을 공유하면서 사용한다는 차이가 존재한다. 


<br>

<hr>

<br>

## ▶ 멀티 프로세스 
>하나의 프로그램을 여러개의 프로세스로 구성하여, 각 프로세스를 병렬 작업 수행하는 것
- 장점 : 메모리 침범 문제를 OS차원에서 해결해주어 `안정성`있음
- 단점 : 
    - 각 프로세스마다 독립된 메모리 영역을 가지고 있어, 작업량이 많을수록 `오버헤드` 발생
    - `Context Switching`으로 인한 성능 저하

<br>


###  ❓ Context Switching이란?
> 프로세스 상태 정보를 저장하고 복원하는 일련의 과정

하나의 프로세스가 CPU를 사용중인데, 다른 프로세스가 CPU를 사용하기 위해서는, `이전의 프로세스 상태를 보관하고 새로운 프로세스의 상태를 적재`하는 작업이다.

혹은, 동작중인 프로세스가 대기하며 해당 프로세스 상태를 보관하고, 대기하고 있던 다음 프로세스가 동작하며 `이전에 보관했던 프로세스 상태를 복구`하는 과정

- 한 프로세스의 문맥은 해당 프로세스의 PCB에 기록됨
- 프로세스는 독립된 메모리영역을 각각 할당받아 사용하므로, 무거운 작업 (ex. 캐시 메모리 초기화) 시 오버헤드가 발생할 확률이 있음


<br>

## ▶ 멀티 스레드 
> 하나의 응용 프로그램에서 여러 스레드를 구성해 각 스레드가 하나의 작업을 처리하는 것

스레드들이 공유 메모리를 통해서 `다수의 작업을 동시에 처리`하도록 함
- 장점 : 
    - 공유메모리만큼 `시간과 자원 손실 감소`
    - 전역/정적 변수 자료 공유 가능
- 단점 :
    - `안전성 문제`
        - 공유 메모리를 갖기 때문에, 하나의 스레드가 데이터 공간을 망가뜨리며 오류 발생시 모든 스레드가 작동 불능 상태가 됨 
        - 이러한 단점은 `Critical Section 기법`으로 대비함.   
        해당 기법은 하나의 스레드가 공유 데이터 값을 변경하는 시점에 다른 스레드가 그 값을 읽으려고 동시 접근하는 문제를 해결하기 위한 동기화 과정임


<br>

## ✅ 멀티 프로세스 가능한 것을 멀티 스레드로 처리하는 이유
1. 멀티 프로세스 구성시, 각 프로세스마다 자원 할당을 받아야하는데, 멀티 스레드로 구성하면 자원 할당하는 `시스템 콜이 감소`하여 `자원의 효율적 관리`가 가능함
2. 프로세스간 통신(IPC)보다 스레드 간의 `통신 비용이 적어` 작업 부담감 감소

유의점 : 대신 멀티 스레드 사용시 공유 자원으로 인한 문제 해결을 위한 '동기화' 신경써야 한다.


<br>


### Reference
https://gyoogle.dev/blog/interview/%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C.html